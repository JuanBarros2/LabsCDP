---
title: "Usando Regressão Linear para Explicar a votação de Deputados"
author: "Juan Barros"
date: "26 de setembro de 2018"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
dados2006 <- read_csv("eleicoes_2006.csv")
dados2010 <- read_csv("eleicoes_2010.csv")
```

### 1- Um modelo de regressão múltipla com todas as variáveis é plausível para explicar a variação em y (número de votos) em 2006? Mesma pergunta para 2010. 

Não. Os dados contidos nessas bases de dados não são totalmente quantitativos, é possível encontrar dados que representam categorias e devem se utilizar de outras estratégias de análise. Desconsiderando esses dados, temos os seguintes modelos:

```{r}
regressaoTotal2006 <- lm(votos ~ media_despesa + total_despesa + quantidade_fornecedores + quantidade_despesas + recursos_de_partido_politico + recursos_proprios + recursos_de_pessoas_juridicas + recursos_de_pessoas_fisicas + recursos_de_outros_candidatos.comites + media_receita + total_receita + quantidade_doadores + quantidade_doacoes, dados2006)

regressaoTotal2010 <- lm(votos ~ media_despesa + total_despesa + quantidade_fornecedores + quantidade_despesas + recursos_de_partido_politico + recursos_proprios + recursos_de_pessoas_juridicas + recursos_de_pessoas_fisicas + recursos_de_outros_candidatos.comites + media_receita + total_receita + quantidade_doadores + quantidade_doacoes, dados2010)

```

No modelo de 2006, temos os seguintes valores obtidos:
```{r}
summary(regressaoTotal2006)
```
Podemos verificar que a maior parte dos parâmetros considerados para a geração do modelo
tem um p-valor baixo, tendo um bom nível descritivo. Contudo, a medida de qualidade de ajuste
do modelo (Multiple R-Squared), indica uma alta quantidade na soma dos resíduos 
amostrais, podendo concluir que o modelo contém muitos pontos não representados pelo modelo
assertivamente.

Em relação ao ano de 2010, temos o seguinte resultado:
```{r}
summary(regressaoTotal2010)
```
No segundo caso, o modelo tem o seu p-valor elevado em quase todos os parâmetros.
Isso, por si só, já nos indica que esse modelo é problemático. Por fim, o R-Quadrado
desse modelo cai e consegue representar menos casos que o anterior.

### 2- Compare as regressões construídas para 2006 e 2010. Quais as diferenças/semelhanças percebidas? Algumas sugestões:

#### a- Analise os plots de resíduos e verifique se há tendências nos erros para cada ano.
```{r}
require(ggplot2)
p1 = ggplot(regressaoTotal2006, aes(.fitted, .resid)) +
    geom_point()
p1 = p1 + geom_hline(yintercept=0, col="red", linetype="dashed")
p1 = p1 + xlab("Valores ajustados") + ylab("Resíduos")
p1 = p1 + ggtitle("Gráfico de Resíduos vs Ajustamento - 2006") + 
    theme_bw()
p1

```
Com o gráfico acima, fica claro perceber que os erros não estão distribuidos uniformemente, tendo
regiões que aglomeram uma quantidade muito alta de pontos. Além disso, a olho nú é possível notar
um pequeno padrão na área inferior ao 0 que respeita a forma de uma reta. Isso pode ter acontecido
pois os parâmetros passados tenham ligação entre si.

```{r}
p1 = ggplot(regressaoTotal2010, aes(.fitted, .resid)) +
    geom_point()
p1 = p1 + geom_hline(yintercept=0, col="red", linetype="dashed")
p1 = p1 + xlab("Valores ajustados") + ylab("Resíduos")
p1 = p1 + ggtitle("Gráfico de Resíduos vs Ajustamento - 2010") + 
    theme_bw()
p1

```
Em 2010, é possível notar que em geral os pontos são localizados no início, não obedecendo a aleatoriedade
esperada em um bom modelo de regressão, além de não parecer simétrica a uma avaliação rápida.

Dessa forma, podemos afirmar que os dois modelos apresentam dispersão de resíduos parecidas,
contudo, não recomendadas para modelos representativos de regressão linear.

#### b- Quais variáveis conseguem explicar melhor o número de votos? Compare essas variáveis entre os modelos. Mesma coisa para as variáveis menos explicativas.
No modelo de 2006, as variáveis que mais explicam o modelo, tendo em vista o sumário gerado na questão 1, são:
Total de despesas, Média da receita e os recursos próprios. Já em 2010, as variáveis são: total de despesa e média da receita.

#### c- Compare os valores de R2 e RSE considerando as regressões para cada ano.
#### d- Inclua outros pontos de comparação que você ache interessante.

### 3- Todas as variáveis são úteis para os modelos de regressão? Há variáveis redudantes? Faça análises para 2006 e 2010 separadamente. 
### 4- No caso de haver variáveis pouco explicativas e/ou redudantes, construa um novo modelo sem essas variáveis e o compare ao modelo com todas as variáveis (e.g. em termos de R2 e RSE). Faça isso para 2006 e 2010 separadamente. 

### 5- Construa agora uma regressão considerando os anos 2006 e 2010 em conjunto. Que diferenças/semelhanças você percebe em relação aos modelos individuais por ano? Veja a questão 2 para sugestões que você usar para comparação.
